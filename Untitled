return {
  "dlants/magenta.nvim",
  lazy = false,
  build = "npm install --frozen-lockfile",
  opts = {
    profiles = {
      {
        name = "local-llama",
        provider = "local",                  -- <-- use local provider
        model = "llama3",                    -- your local model
        server = "http://127.0.0.1:35203",  -- local Ollama server
        isLocal = true,                      -- treat as local-only
        useTools = false,                    -- disable tools
      },
    },
    sidebarPosition = "right",
    picker = "telescope",
    defaultKeymaps = false,
    chimeVolume = 0.3,
  },
  keys = {
    { "<leader>mt", "<cmd>MagentaToggleSidebar<cr>", desc = "Toggle Magenta sidebar" },
    { "<leader>mc", "<cmd>MagentaNewChat<cr>", desc = "New Magenta chat" },
    { "<leader>ma", "<cmd>MagentaAddSelection<cr>", desc = "Add selection to chat", mode = "v" },
    { "<leader>ms", "<cmd>MagentaSendMessage<cr>", desc = "Send message to Magenta" },
    { "<leader>me", "<cmd>MagentaExplain<cr>", desc = "Explain selection", mode = "v" },
    { "<leader>mf", "<cmd>MagentaFix<cr>", desc = "Fix code issues", mode = "v" },
    { "<leader>mr", "<cmd>MagentaRefactor<cr>", desc = "Refactor selection", mode = "v" },
    { "<leader>mp", "<cmd>MagentaSelectProfile<cr>", desc = "Select Magenta profile" },
    { "<leader>mx", "<cmd>MagentaClearChat<cr>", desc = "Clear current chat" },
  },
}

